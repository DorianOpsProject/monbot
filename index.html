<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GIO Shop</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  darkMode:'class',
  theme:{
    extend:{
      colors:{
        bg0:'#05070D',
        bg1:'#0B1020',
        accent:'#FFD400',
        accent2:'#FFB800',
        text:'rgba(250,253,255,.96)',
        muted:'rgba(250,253,255,.66)',
        muted2:'rgba(250,253,255,.48)',
      },
      borderRadius:{ xl2:'18px', xl3:'24px', xl4:'28px' },
      fontFamily:{ ui:['ui-sans-serif','system-ui','-apple-system','"SF Pro Display"','"SF Pro Text"','Segoe UI','Roboto','Helvetica','Arial','"Apple Color Emoji"','"Segoe UI Emoji"'] }
    }
  }
}
</script>
</head>
<body class="bg-bg0 text-text font-ui pt-24">

<!-- HEADER FIXE -->
<header class="fixed top-0 left-0 right-0 bg-bg1 border-b border-white/10 px-6 py-4 z-50">
  <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-2">
    <div>
      <h1 class="text-3xl font-extrabold tracking-tight">GIO Shop</h1>
      <p class="text-sm text-muted">La Cali avant tout</p>
    </div>
    <div class="flex flex-col md:flex-row md:items-center gap-2 mt-2 md:mt-0">
      <input type="search" id="search" placeholder="Recherche..." class="px-4 py-2 rounded-xl2 bg-bg0/80 border border-white/10 placeholder:text-muted focus:outline-none w-full md:w-60">
      <div class="flex gap-2 mt-2 md:mt-0">
        <button data-filter="salade" class="px-3 py-2 rounded-xl2 bg-accent font-black text-black hover:bg-accent2 transition">Salade</button>
        <button data-filter="chocolat" class="px-3 py-2 rounded-xl2 bg-accent font-black text-black hover:bg-accent2 transition">Chocolat</button>
      </div>
    </div>
  </div>
</header>

<!-- CATALOGUE -->
<section id="catalogue" class="grid gap-6 px-6 pb-32 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"></section>

<!-- DRAWER PANIER -->
<div id="drawerBackdrop" class="fixed inset-0 bg-black/50 hidden z-40"></div>
<div id="drawer" class="fixed right-0 top-0 h-full w-96 bg-bg1 shadow-xl transform translate-x-full transition-transform duration-300 flex flex-col z-50">
  <div class="flex justify-between items-center p-4 border-b border-white/10">
    <h2 class="font-black text-xl">Panier</h2>
    <button id="closeDrawer" class="text-text font-black text-lg">&times;</button>
  </div>
  <div id="drawerContent" class="p-4 flex-1 overflow-y-auto space-y-3"></div>
  <div class="p-4 border-t border-white/10 space-y-3">
    <input type="text" id="customerName" placeholder="Nom" class="w-full px-3 py-2 rounded-xl2 bg-bg0/50 border border-white/10 text-text placeholder:text-muted">
    <input type="text" id="customerAddress" placeholder="Adresse de livraison" class="w-full px-3 py-2 rounded-xl2 bg-bg0/50 border border-white/10 text-text placeholder:text-muted">
    <div id="drawerTotal" class="font-black text-lg">Total : 0 ‚Ç¨</div>
    <button id="sendOrder" class="w-full px-4 py-2 rounded-xl2 border border-white/10 bg-accent text-black font-black hover:bg-accent2 transition">Envoyer la commande</button>
    <button id="clearCart" class="w-full px-4 py-2 rounded-xl2 border border-white/10 bg-white/5 text-text font-black hover:bg-white/10 transition">Vider le panier</button>
  </div>
</div>

<!-- BOUTON PANIER FLOTTANT -->
<button id="openDrawer" class="fixed bottom-6 right-6 bg-accent text-black px-4 py-3 rounded-full font-black shadow-lg hover:bg-accent2 transition z-50">Panier</button>

<script>
/* ==============================
   DONN√âES PRODUITS
============================== */
const PRODUCTS = [
  {id:"P01",name:"Mousseux",thc:18,origin:"üá≤üá¶",price:10},
  {id:"P02",name:"Static",thc:22,origin:"üá≤üá¶",price:12},
  {id:"P03",name:"Frozen",thc:25,origin:"üá≤üá¶",price:15},
  {id:"P04",name:"Beldia",thc:20,origin:"üá≤üá¶",price:12},
  {id:"P05",name:"Produit 05",thc:17,origin:"üá≥üá±",price:8},
  {id:"P06",name:"Produit 06",thc:19,origin:"üá≥üá±",price:11},
  {id:"P07",name:"Cali Plates",thc:23,origin:"üá∫üá∏",price:20},
  {id:"P08",name:"Cali NL",thc:21,origin:"üá≥üá±",price:10},
  {id:"P09",name:"Cali US",thc:24,origin:"üá∫üá∏",price:22},
  {id:"P10",name:"Produit 10",thc:20,origin:"üá∫üá∏",price:18},
  {id:"P11",name:"Cali Canadienne",thc:18,origin:"üá®üá¶",price:12},
];

/* ==============================
   STATE
============================== */
let state = { cart: {}, query:"" };

/* ==============================
   HELPERS
============================== */
function money(n){return Number(n||0).toFixed(2)+' ‚Ç¨';}

/* ==============================
   RENDER CATALOGUE
============================== */
const catalogueEl = document.getElementById('catalogue');
function renderCatalogue(){
  const q = state.query.toLowerCase();
  catalogueEl.innerHTML='';
  const filtered = PRODUCTS.filter(p => p.name.toLowerCase().includes(q) || p.origin.toLowerCase().includes(q));
  if(filtered.length===0){
    catalogueEl.innerHTML='<div class="text-muted text-center col-span-full">Aucun produit trouv√©.</div>';
    return;
  }

  filtered.forEach(p=>{
    const qty = state.cart[p.id]?.qty || 0;
    const grams = state.cart[p.id]?.grams || 1;

    const card = document.createElement('div');
    card.className='bg-bg1 border border-white/10 rounded-xl3 p-4 flex flex-col justify-between shadow-lg hover:shadow-2xl transition';
    card.innerHTML=`
      <div class="flex justify-between items-start mb-3">
        <div>
          <div class="font-black text-lg">${p.name}</div>
          <div class="text-sm text-muted">${p.thc}% THC ‚Ä¢ ${p.origin}</div>
          <div class="text-sm font-black mt-1">${money(p.price)} / g</div>
        </div>
        <div class="text-sm font-black text-muted">${qty>0?qty+'√ó':''}</div>
      </div>

      <div class="mb-3">
        <label for="slider-${p.id}" class="text-sm text-muted font-black">Grammes : <span id="sliderVal-${p.id}" class="text-accent">${grams}</span>g</label>
        <input id="slider-${p.id}" type="range" min="1" max="10" value="${grams}" class="w-full h-2 bg-white/10 rounded-xl2 accent-accent">
      </div>

      <button data-act="add" data-id="${p.id}" class="mt-2 w-full px-3 py-2 rounded-xl2 border border-white/10 bg-accent text-black font-black hover:bg-accent2 transition">Ajouter</button>
    `;
    catalogueEl.appendChild(card);

    const slider = card.querySelector(`#slider-${p.id}`);
    const sliderVal = card.querySelector(`#sliderVal-${p.id}`);
    slider.addEventListener('input', e => sliderVal.textContent=e.target.value);
  });
}

/* ==============================
   HANDLE ACTIONS
============================== */
catalogueEl.addEventListener('click', e=>{
  const btn = e.target.closest('button');
  if(!btn) return;
  const act = btn.dataset.act;
  const id = btn.dataset.id;
  if(!id) return;

  const slider = document.getElementById(`slider-${id}`);
  const grams = Number(slider?.value || 1);

  if(act==='add'){
    if(state.cart[id]){ state.cart[id].qty +=1; state.cart[id].grams = grams; }
    else{ state.cart[id] = {qty:1, grams}; }
  }
  renderDrawer();
});

/* ==============================
   SEARCH
============================== */
document.getElementById('search').addEventListener('input', e=>{state.query=e.target.value; renderCatalogue();});
document.querySelectorAll('[data-filter]').forEach(btn=>btn.addEventListener('click', e=>{
  state.query = btn.dataset.filter;
  document.getElementById('search').value = btn.dataset.filter;
  renderCatalogue();
}));

/* ==============================
   DRAWER
============================== */
const drawer = document.getElementById('drawer');
const drawerBackdrop = document.getElementById('drawerBackdrop');
const drawerContent = document.getElementById('drawerContent');
const drawerTotal = document.getElementById('drawerTotal');

function renderDrawer(){
  drawerContent.innerHTML='';
  const items = Object.entries(state.cart);
  if(items.length===0){ drawerContent.innerHTML='<div class="text-muted text-center">Panier vide</div>'; drawerTotal.textContent='Total : 0 ‚Ç¨'; return; }

  let total=0;
  items.forEach(([id,{qty,grams}])=>{
    const p = PRODUCTS.find(x=>x.id===id);
    const lineTotal = p.price * qty * grams;
    total += lineTotal;

    const itemEl = document.createElement('div');
    itemEl.className='flex justify-between items-center bg-bg0/20 p-3 rounded-xl2';
    itemEl.innerHTML=`
      <div>
        <div class="font-black">${p.name}</div>
        <div class="text-sm text-muted">${grams}g √ó ${qty}</div>
      </div>
      <div class="font-black">${money(lineTotal)}</div>
    `;
    drawerContent.appendChild(itemEl);
  });

  drawerTotal.textContent=`Total : ${money(total)}`;
}

document.getElementById('openDrawer').addEventListener('click', ()=>{drawer.classList.remove('translate-x-full'); drawerBackdrop.classList.remove('hidden');});
document.getElementById('closeDrawer').addEventListener('click', closeDrawer);
drawerBackdrop.addEventListener('click', closeDrawer);
function closeDrawer(){ drawer.classList.add('translate-x-full'); drawerBackdrop.classList.add('hidden');}

/* ==============================
   CLEAR / SEND ORDER
============================== */
document.getElementById('clearCart').addEventListener('click', ()=>{
  state.cart={};
  renderCatalogue();
  renderDrawer();
});

document.getElementById('sendOrder').addEventListener('click', ()=>{
  const name = document.getElementById('customerName').value.trim();
  const address = document.getElementById('customerAddress').value.trim();
  if(!name||!address){ alert('Veuillez remplir nom et adresse'); return; }

  const items = Object.entries(state.cart).map(([id,{qty,grams}])=>{
    const p = PRODUCTS.find(x=>x.id===id);
    return `${p.name} ${grams}g √ó${qty} = ${money(p.price*qty*grams)}`;
  }).join('\n');

  const total = Object.entries(state.cart).reduce((sum,[id,{qty,grams}])=>{
    const p = PRODUCTS.find(x=>x.id===id);
    return sum + p.price*qty*grams;
  },0);

  const message = `Commande GIO Shop\nNom: ${name}\nAdresse: ${address}\n\n${items}\nTotal: ${money(total)}`;

  // Telegram link (remplacer <USERNAME> par ton compte)
  const telegramUrl = `https://t.me/<USERNAME>?text=${encodeURIComponent(message)}`;
  window.open(telegramUrl,'_blank');
});

/* ==============================
   INITIALIZE
============================== */
renderCatalogue();
renderDrawer();
</script>
</body>
</html>
