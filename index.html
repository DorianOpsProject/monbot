<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nebula Market ‚Äî Mini App</title>

  <!-- Telegram Mini App SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            bg0: '#070916',
            bg1: '#0C1024',
            glass: 'rgba(255,255,255,.05)',
            stroke: 'rgba(255,255,255,.08)',
            text: 'rgba(240,244,255,.95)',
            muted: 'rgba(240,244,255,.6)',
            accent: '#6EE7FF',
            accent2: '#8B5CF6',
            good: '#22D3EE',
            bad: '#FB7185'
          },
          boxShadow: {
            soft: '0 10px 30px rgba(0,0,0,.45)',
            glow: '0 0 0 1px rgba(110,231,255,.15), 0 20px 60px rgba(139,92,246,.25)'
          },
          borderRadius: {
            xl3: '22px',
            xl4: '30px'
          }
        }
      }
    }
  </script>
</head>

<body class="min-h-screen text-text font-sans
bg-[radial-gradient(900px_600px_at_20%_-10%,rgba(139,92,246,.18),transparent_60%),radial-gradient(900px_600px_at_90%_10%,rgba(110,231,255,.18),transparent_55%),linear-gradient(180deg,#070916,#0C1024)]">

<!-- APP -->
<div class="max-w-[920px] mx-auto px-4 pb-32">

  <!-- HEADER -->
  <header class="sticky top-0 z-20 backdrop-blur-xl
  bg-gradient-to-b from-[#070916]/90 to-[#070916]/60
  border-b border-white/5 py-4 mb-4">

    <div class="flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="h-11 w-11 rounded-xl4 bg-gradient-to-br from-accent to-accent2
        flex items-center justify-center text-[#0B0F1E] font-black shadow-glow">
          ‚ú¶
        </div>
        <div>
          <h1 class="font-black text-[17px]">Nebula Market</h1>
          <p class="text-[12px] text-muted">Catalogue priv√© ‚Ä¢ Commande rapide</p>
        </div>
      </div>

      <button id="openCart"
        class="relative h-11 w-11 rounded-xl3 border border-white/10 bg-glass shadow-soft">
        üõí
        <span id="cartBadge"
          class="absolute -top-1 -right-1 h-5 min-w-[20px] px-1 rounded-full
          bg-gradient-to-br from-accent to-accent2 text-[#0B0F1E]
          text-[11px] font-black grid place-items-center">0</span>
      </button>
    </div>

    <input id="search" type="search"
      placeholder="Rechercher un produit‚Ä¶"
      class="mt-4 w-full rounded-xl3 border border-white/10 bg-glass
      px-4 py-3 text-[14px] outline-none placeholder:text-muted">
  </header>

  <!-- PRODUCTS -->
  <main id="list" class="grid gap-4"></main>

  <div id="empty" class="hidden text-center text-muted mt-12">
    Aucun produit trouv√©
  </div>

</div>

<!-- CART MODAL -->
<div id="cartMask" class="fixed inset-0 bg-black/60 opacity-0 pointer-events-none transition"></div>

<div id="cart"
class="fixed bottom-0 left-1/2 -translate-x-1/2 w-[min(920px,100%)]
bg-[#0B0F1E]/95 backdrop-blur-xl border border-white/10 rounded-t-xl4
shadow-glow transition-all duration-300"
style="bottom:-100%">

  <div class="p-4 border-b border-white/10 flex justify-between">
    <h2 class="font-black">Panier</h2>
    <button id="closeCart" class="text-muted">Fermer</button>
  </div>

  <div id="cartItems" class="p-4 max-h-[50vh] overflow-auto"></div>

  <div class="p-4 border-t border-white/10">
    <div class="flex justify-between text-sm text-muted">
      <span>Total indicatif</span>
      <b id="total">0 ‚Ç¨</b>
    </div>

    <button id="order"
      class="mt-4 w-full rounded-xl3 py-3 font-black
      bg-gradient-to-br from-accent to-accent2
      text-[#0B0F1E]">
      Commander via Telegram
    </button>
  </div>
</div>

<script>
/* =======================
   DATA
======================= */
const CONTACT_USERNAME = "USERNAME_TELEGRAM"; // SANS @

const PRODUCTS = [
  { id:"P01", name:"Produit Alpha", price:10, desc:"Qualit√© premium" },
  { id:"P02", name:"Produit Beta", price:15, desc:"Stock limit√©" },
  { id:"P03", name:"Produit Gamma", price:20, desc:"Best seller" }
];

/* =======================
   STATE
======================= */
let cart = {};
const el = {
  list: document.getElementById("list"),
  empty: document.getElementById("empty"),
  search: document.getElementById("search"),
  openCart: document.getElementById("openCart"),
  closeCart: document.getElementById("closeCart"),
  cart: document.getElementById("cart"),
  cartMask: document.getElementById("cartMask"),
  cartItems: document.getElementById("cartItems"),
  cartBadge: document.getElementById("cartBadge"),
  total: document.getElementById("total"),
  order: document.getElementById("order")
};

/* =======================
   RENDER
======================= */
function renderProducts() {
  const q = el.search.value.toLowerCase();
  el.list.innerHTML = "";

  const filtered = PRODUCTS.filter(p =>
    p.name.toLowerCase().includes(q)
  );

  el.empty.classList.toggle("hidden", filtered.length);

  filtered.forEach(p => {
    const qty = cart[p.id] || 0;

    const card = document.createElement("div");
    card.className = "rounded-xl4 border border-white/10 bg-glass p-4 shadow-soft";

    card.innerHTML = `
      <h3 class="font-black">${p.name}</h3>
      <p class="text-muted text-sm mt-1">${p.desc}</p>
      <div class="mt-3 flex justify-between items-center">
        <b>${p.price} ‚Ç¨</b>
        <button data-id="${p.id}"
        class="add rounded-xl3 px-4 py-2 font-black
        bg-gradient-to-br from-accent to-accent2 text-[#0B0F1E]">
          ${qty ? "Ajout√© x"+qty : "Ajouter"}
        </button>
      </div>
    `;

    card.querySelector(".add").onclick = () => {
      cart[p.id] = (cart[p.id] || 0) + 1;
      renderAll();
    };

    el.list.appendChild(card);
  });
}

function renderCart() {
  el.cartItems.innerHTML = "";
  let total = 0;
  let count = 0;

  for (const id in cart) {
    const p = PRODUCTS.find(x => x.id === id);
    const qty = cart[id];
    const line = qty * p.price;
    total += line;
    count += qty;

    const row = document.createElement("div");
    row.className = "mb-3 flex justify-between";

    row.innerHTML = `
      <span>${p.name} x${qty}</span>
      <b>${line} ‚Ç¨</b>
    `;
    el.cartItems.appendChild(row);
  }

  el.total.textContent = total + " ‚Ç¨";
  el.cartBadge.textContent = count;
}

/* =======================
   CART UI
======================= */
function openCart() {
  el.cart.style.bottom = "0";
  el.cartMask.classList.remove("opacity-0","pointer-events-none");
}
function closeCart() {
  el.cart.style.bottom = "-100%";
  el.cartMask.classList.add("opacity-0","pointer-events-none");
}

/* =======================
   ORDER
======================= */
function order() {
  if (!Object.keys(cart).length) return;

  let msg = "üõí Commande Nebula Market\n\n";
  for (const id in cart) {
    const p = PRODUCTS.find(x => x.id === id);
    msg += `‚Ä¢ ${p.name} x${cart[id]}\n`;
  }
  msg += "\nMerci de confirmer üôè";

  const url = `https://t.me/${CONTACT_USERNAME}?text=${encodeURIComponent(msg)}`;
  window.open(url, "_blank");
}

/* =======================
   EVENTS
======================= */
el.search.oninput = renderProducts;
el.openCart.onclick = openCart;
el.closeCart.onclick = closeCart;
el.cartMask.onclick = closeCart;
el.order.onclick = order;

/* =======================
   INIT
======================= */
renderProducts();
renderCart();

function renderAll() {
  renderProducts();
  renderCart();
}
</script>

</body>
</html>
