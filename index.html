<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GIO Shop</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    darkMode:'class',
    theme: {
      extend: {
        colors: {
          bg0:'#0A0C14',
          bg1:'#121622',
          accent:'#FFD400',
          accent2:'#FFB800',
          text:'rgba(250,253,255,.96)',
          muted:'rgba(250,253,255,.66)',
          muted2:'rgba(250,253,255,.48)',
          good:'#2EE59D',
          bad:'#FF4D4D',
        },
        borderRadius:{
          xl2:'16px',
          xl3:'22px',
          xl4:'28px'
        },
        fontFamily:{
          ui:['ui-sans-serif','system-ui','-apple-system','"SF Pro Display"','"SF Pro Text"','Segoe UI','Roboto','Helvetica','Arial','"Apple Color Emoji"','"Segoe UI Emoji"']
        },
        boxShadow: {
          card: '0 10px 25px rgba(0,0,0,0.25)',
        }
      }
    }
  }
</script>
<style>
  /* Graffiti logo style */
  @import url('https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap');
</style>
</head>
<body class="min-h-screen font-ui bg-bg0 text-text px-4">

<!-- HEADER FIXE -->
<header class="fixed top-0 left-0 right-0 bg-bg1 border-b border-white/10 z-50 flex items-center justify-between px-4 py-3">
  <div class="flex items-center gap-3">
    <h1 class="text-2xl text-accent font-bold" style="font-family: 'Permanent Marker', cursive;">GIO Shop</h1>
    <span class="text-sm text-muted">La Cali avant tout</span>
  </div>
  <div id="cartBadge" class="relative cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-text" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.5 7h13L17 13M7 13L5.4 5M17 13l1.5 7M6 21h.01M18 21h.01"/>
    </svg>
    <span id="cartCount" class="absolute -top-2 -right-2 bg-accent text-black text-xs font-black rounded-full px-2 py-0.5">0</span>
  </div>
</header>

<div class="h-20"></div> <!-- espace pour header -->

<!-- CATALOGUE -->
<section id="catalogue" class="grid gap-4"></section>

<!-- DRAWER PANIER -->
<div id="cartDrawer" class="fixed top-0 right-[-400px] w-96 h-full bg-bg1 shadow-xl transition-all z-50 flex flex-col">
  <div class="p-4 border-b border-white/10 flex justify-between items-center">
    <h2 class="font-black text-xl">Votre Panier</h2>
    <button id="closeCart" class="text-text font-black">‚úï</button>
  </div>
  <div class="p-4 flex-1 overflow-y-auto" id="cartItems"></div>
  <div class="p-4 border-t border-white/10">
    <input id="customerName" type="text" placeholder="Nom" class="w-full rounded-xl2 px-3 py-2 mb-2 bg-bg0 border border-white/10 text-text outline-none"/>
    <input id="deliveryAddr" type="text" placeholder="Adresse" class="w-full rounded-xl2 px-3 py-2 mb-4 bg-bg0 border border-white/10 text-text outline-none"/>
    <div class="flex justify-between mb-4">
      <span class="font-black">Total:</span>
      <span id="cartTotal" class="font-black">0 ‚Ç¨</span>
    </div>
    <button id="sendOrder" class="w-full px-4 py-3 bg-accent text-black font-black rounded-xl3">Envoyer la commande</button>
  </div>
</div>

<script>
/* ==============================
   DONN√âES PRODUITS
   ============================== */
const PRODUCTS = [
  {id:"P01",name:"Mousseux",thc:22,origin:"üá≤üá¶",price:10},
  {id:"P02",name:"Static",thc:18,origin:"üá≤üá¶",price:12},
  {id:"P03",name:"Frozen",thc:25,origin:"üá≤üá¶",price:15},
  {id:"P04",name:"Beldia",thc:20,origin:"üá≤üá¶",price:12},
  {id:"P05",name:"Cali NL",thc:19,origin:"üá≥üá±",price:10},
  {id:"P06",name:"Cali US",thc:23,origin:"üá∫üá∏",price:22},
];

/* ==============================
   STATE
   ============================== */
let state = { cart: {}, query:"" };

/* ==============================
   HELPERS
   ============================== */
function money(n){return Number(n||0).toFixed(2)+' ‚Ç¨';}

/* ==============================
   RENDER CATALOGUE
   ============================== */
const catalogueEl = document.getElementById('catalogue');
function renderCatalogue(){
  catalogueEl.innerHTML='';
  PRODUCTS.forEach(p=>{
    const qty = state.cart[p.id]?.qty||0;
    const card = document.createElement('div');
    card.className='bg-bg1 rounded-xl3 p-4 shadow-card flex flex-col gap-2 transition-all relative';
    card.innerHTML=`
      <div class="flex justify-between items-center">
        <div>
          <div class="font-black text-lg">${p.name}</div>
          <div class="text-sm text-muted">${p.origin} ‚Ä¢ THC ${p.thc}%</div>
        </div>
        <div class="text-right font-black text-lg">${money(p.price)}/g</div>
      </div>
      <input type="range" min="1" max="100" value="${qty||1}" data-id="${p.id}" class="w-full mt-2 slider" />
      <div class="flex justify-between items-center mt-2">
        <span class="text-sm text-muted">Quantit√©: <span id="qty-${p.id}">${qty||1}</span>g</span>
        <button data-id="${p.id}" class="px-3 py-1 rounded-xl2 bg-accent font-black text-black add-btn">Ajouter</button>
      </div>
      <div class="absolute -top-3 right-3 text-xs bg-good px-2 py-0.5 rounded-full hidden" id="added-${p.id}">Ajout√© !</div>
    `;
    catalogueEl.appendChild(card);
  });
}

/* ==============================
   EVENT LISTENERS
   ============================== */
catalogueEl.addEventListener('input', e=>{
  if(e.target.classList.contains('slider')){
    const id=e.target.dataset.id;
    document.getElementById(`qty-${id}`).textContent=e.target.value;
  }
});

catalogueEl.addEventListener('click', e=>{
  const btn = e.target.closest('.add-btn');
  if(!btn) return;
  const id = btn.dataset.id;
  const slider = document.querySelector(`input[data-id='${id}']`);
  const qty = parseInt(slider.value);
  if(!state.cart[id]) state.cart[id]={qty:0};
  state.cart[id].qty += qty;
  showAdded(id);
  renderCart();
  updateBadge();
});

function showAdded(id){
  const el = document.getElementById(`added-${id}`);
  el.classList.remove('hidden');
  setTimeout(()=>el.classList.add('hidden'),1000);
}

/* ==============================
   CART DRAWER
   ============================== */
const cartDrawer = document.getElementById('cartDrawer');
document.getElementById('cartBadge').addEventListener('click', ()=>cartDrawer.style.right='0');
document.getElementById('closeCart').addEventListener('click', ()=>cartDrawer.style.right='-400px');

const cartItemsEl = document.getElementById('cartItems');
const cartTotalEl = document.getElementById('cartTotal');
const cartCountEl = document.getElementById('cartCount');

function renderCart(){
  cartItemsEl.innerHTML='';
  let total=0, count=0;
  Object.entries(state.cart).forEach(([id, data])=>{
    const p = PRODUCTS.find(x=>x.id===id);
    if(p){
      const lineTotal = p.price*data.qty;
      total+=lineTotal;
      count+=data.qty;
      const item = document.createElement('div');
      item.className='flex justify-between items-center mb-2';
      item.innerHTML=`
        <div>
          <div class="font-black">${p.name} ${p.origin}</div>
          <div class="text-sm text-muted">${data.qty}g ‚Ä¢ ${money(lineTotal)}</div>
        </div>
        <button data-id="${id}" class="text-red-500 font-black remove-btn">√ó</button>
      `;
      cartItemsEl.appendChild(item);
    }
  });
  cartTotalEl.textContent=money(total);
  cartCountEl.textContent=count;
}

/* ==============================
   REMOVE ITEM
   ============================== */
cartItemsEl.addEventListener('click', e=>{
  const btn = e.target.closest('.remove-btn');
  if(!btn) return;
  const id = btn.dataset.id;
  delete state.cart[id];
  renderCart();
});

/* ==============================
   SEND ORDER
   ============================== */
document.getElementById('sendOrder').addEventListener('click', ()=>{
  const name = document.getElementById('customerName').value.trim();
  const addr = document.getElementById('deliveryAddr').value.trim();
  if(!name||!addr){alert('Merci de renseigner nom et adresse'); return;}
  let msg=`Commande de ${name} (${addr}):\n`;
  Object.entries(state.cart).forEach(([id,data])=>{
    const p=PRODUCTS.find(x=>x.id===id);
    if(p) msg+=`- ${p.name} ${p.origin} ${data.qty}g = ${money(p.price*data.qty)}\n`;
  });
  msg+=`Total: ${cartTotalEl.textContent}`;
  const telegramLink = `https://t.me/TONCOMPTE?text=${encodeURIComponent(msg)}`;
  window.open(telegramLink,'_blank');
});
  
/* ==============================
   INITIALIZE
   ============================== */
renderCatalogue();
renderCart();
</script>
</body>
</html>
